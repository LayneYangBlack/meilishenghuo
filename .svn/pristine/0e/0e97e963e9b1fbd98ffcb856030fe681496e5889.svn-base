<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport"
          content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
    <title>HTML</title>
    <!-- Replace favicon.ico & apple-touch-icon.png in the root of your domain and delete these references -->

    <link rel="stylesheet" type="text/css" href="../../css/api.css"/>
    <style>

        html {
            width: 100%;
            height: 100%;
        }

        body {
            background: #ebebeb;
            width: 100%; /*height: 100%;*/
            min-height: 100%;
        }


        .item {
            margin: 10px 0px ;
            /*border-bottom: 1px solid #EDEDED;*/
            /*min-height: 85px;*/
            height: auto;
            background: #FFF;
            padding: 5px 15px;

        }
        .item9 img{

            width: 100%;
        }
        .item1 {
            margin: 10px 0px ;
            /*border-bottom: 1px solid #EDEDED;*/
            /*min-height: 85px;*/
            height: auto;
            background: #f1f2f3;
            padding: 5px 15px;

        }

        .itemOn {
            background: #EDEDED;
        }

        .title{
            overflow : hidden;
            text-overflow: ellipsis;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            font-weight: 600;;
            font-size:18px;
            line-height: 1.5rem;;
        }

        .itemLeft{
            width: 50%;
            float: left;
            height: 50px;
            line-height: 50px;
            font-size: 14px;
        }

        a:link{
            color: #9E9E9E;;
        }

        .name{
            margin-top: -2px;
            margin-right:20px ;
            height: 34px;
            font-size: 14px;
            color: #9E9E9E;
            line-height: 18px;

            overflow : hidden;
            text-overflow: ellipsis;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
        }

        .itemRight{
            width: 50%;
            float: right;
            height: 50px;
            background-color: #76CA78;
            color: #ffffff;
            text-align: center;
        }
        .itemLeft span{
            color: #FA8302;
            font-size: 30px;
        }



        .info_1{
            margin-top: 5px ;
            height: 23px;
        }
        .info_2{
            height: 30px;
            font-size:16px;
            color: #9E9E9E;
            line-height: 30px;
            text-align: center;
            padding-right:5px ;
            margin-bottom: 10px;
            margin-top: 5px;

        }

        .tagButton{
            padding: 2px 10px 2px 0px;
            width: auto;
            margin-right: 10px ;
            color: #f1f2f3;
            text-align: center;
            font-size: 12px;
            border-right: 1px solid #fff;
        }

        .tagButton2{
            color: #FA8200;
            font-size: 1.4em;
            margin:0 3px;
        }
        .type{
            color: #75CA77;
        }
        #infoList{
            font-size: 16px;
        }
        #infoList span{
            margin-left: 1rem;;
        }

        #infoList  ul li{
            list-style: none;
            line-height: 30px;
            color: #9296a3;
            height: 30px;
            margin-top: 10px;
        }
        #infoList li img{
            height: 20px;
            margin-right: 5px;
            float: left;
            margin-top: 5px;
        }

        #infoList .right_icon{
            height: 16px;
            float:right;
            margin-top:7px
        }

        .distance{
            margin-right: 5px;
        }

        #question{
            position: fixed;
            height: 50px;
            text-align: center;
            background-color: #fff;
            margin: 10px 0 0 0 ;

            font-size: 18px;
            line-height: 50px;;
            width: 100%;
            bottom: 0;
        }
        .item p{
            margin: 10px 0;
        }
        .itemResult{
            width: 100%;
            float: right;
            height: 50px;
            background-color: #ccc;
            color: #ffffff;
            text-align: center;
        }

    </style>
</head>

<body>

<div id="mainDiv">

    <div id="main">
        <!--<div id="header">-->
            <!--<div class="item" >-->
                <!--<div class="title">-->
                    <!--星巴克水电费家里的事解放路会计分录圣诞节发牢骚的几率-->
                <!--</div>-->
                <!--<div id="infoList">-->
                    <!--<ul>-->
                        <!--<li><img src="../../icon/order/mall@2x.png"><span>北京全聚德烤鸭店</span></li>-->
                        <!--<li tapmode="itemOn" onclick=""><a style="width:100%; " href="tel:010-11011010"><img src="../../icon/icon_phone.png"><span>010-11011010</span><img class="right_icon"  src="../../icon/icon_right_normal.png"></a></li>-->
                        <!--<li tapmode="itemOn"> <img  src="../../icon/icon_location.png"><span class="distance">2.6公里</span><span>中关村南大街2号</span><img class="right_icon"  src="../../icon/icon_right_normal.png"></li>-->
                    <!--</ul>-->
                <!--</div>-->
                <!--<div class="info_2">-->
                    <!--<span><span class="tagButton2">360</span>金豆/份</span>　　-->
                    <!--<span>剩余<span style="margin:0 3px;font-size: 1.4em;color: #76CA78">5</span>份</span>-->
                <!--</div>-->
            <!--</div>-->
        <!--</div>-->
        <!--<div class="item item9" tapmode="itemOn" onclick="showDialog();">-->
            <!--<img width="100%" src="../../image/test/q.jpg">-->
            <!--<div style="line-height: 1.5rem;">　　全聚德的特色菜是北京烤鸭，对选鸭、填餵、宰杀，到烧烤几个步骤要求都极高。全聚德选的北京填鸭都是不足百天，体重在五斤以上的北京鸭。被宰杀褪毛的鸭子在右膀下被挖个小洞，-->
                <!--处理人员伸二指入这个小洞取出内脏，然后用净水把鸭子里外洗净，处理人员用嘴把鸭皮吹鼓，插一节秫秸到鸭尾裡，把清水从鸭膀下的洞灌入，并用丝线将洞口缝合。完成后，鸭子被挂在钩上入炉烤。-->
                <!--如此外烤内煮，鸭子便烤好，外皮呈油黄。吃入口中，鸭肉特别鲜嫩，肉虽肥而不腻，味美香甜，常吃不厌。-->
                <!--全聚德的挂炉烤鸭选用果木（如：枣木、梨木）為燃料進行烤製，果木为硬木，耐烤，火底足，烤出来的鸭子多多少少有些果木香。炉子不安炉门，烤製的同時，还要往鸭子上面淋/刷油，以防止烤糊。-->
                <!--用餐完毕后服务员会发给一张纪念明信片，上面记载本次用餐为全聚德创立迄今售出的第几只烤鸭。-->
            <!--</div>-->
            <!--<img width="100%" src="../../image/test/c.jpg">-->
            <!--<div>-->
                <!--<p>微信公众号：hhhjddd</p>-->
                <!--<p>网站：wwww.baidu.com</p>-->
            <!--</div>-->
        <!--</div>-->
        <!--<div class="item" style="height: 30px"></div>-->
        <!--<div  id="question" tapmode="itemOn">-->
            <!--<div class="itemLeft">今天还有<span>3</span>次答题机会</div>-->
            <!--<div class="itemRight" onclick="openQuestion()">开始抢答 </div>-->
        <!--</div>-->
</div>
    </div>
</body>
<script id="scriptDiv" type="text/html">
    <div id="header">
        <div class="item" >
            <div class="title">
                <%=list.title%>
            </div>
            <div id="infoList">
                <ul>
                    <li><img src="../../icon/shop_icon.png"><span><%=list.shopName%></span></li>
                    <li tapmode="itemOn" onclick=""><a style="width:100%; " href="tel:<%=list.shopPhone%>"><img src="../../icon/phone_icon.png"><span><%=list.shopPhone%></span><img class="right_icon"  src="../../icon/icon_right_normal.png"></a></li>
                    <li tapmode="itemOn"> <img  src="../../icon/address@2x.png"><span class="distance">2.6公里</span><span><%=list.shopAddress%></span><img class="right_icon"  src="../../icon/icon_right_normal.png"></li>
                </ul>
            </div>
            <div class="info_2">
                <span><span class="tagButton2"><%=list.goldBean%></span>金豆/份</span>　　
                <span>剩余<span style="margin:0 3px;font-size: 1.4em;color: #76CA78"><%=list.remainNum%></span>份</span>
            </div>
        </div>
    </div>
    <div class="item item9" >
        <div style="line-height: 1.5rem;">　
            <%=list.contentDecode%>
        </div>
    </div>
    <div class="item1" style="height: 30px"></div>
    <div  id="question" >
        <%if (list.finish == 0){%>
        <div class="itemLeft">今天还有<span><%=list.remainAnswerNum%></span>次答题机会</div>
        <div class="itemRight" tapmode="itemOn" onclick="getQuestionInfo()">开始抢答 </div>
        <%}else{%>
        <div class="itemResult">已获奖 </div>
        <%}%>
    </div>


</script>
<script type="text/javascript" src="../../script/api.js"></script>
<script type="text/javascript" src="../../script/template-native.js"></script>
<script type="text/javascript" src="../../script/kv.js"></script>
<script type="text/javascript" src="../../script/user.js"></script>
<script type="text/javascript" src="../../script/data.js"></script>
<script type="text/javascript" src="../../script/util.js"></script>
<script type="text/javascript" src="../../script/apiCloud.js"></script>
<script type="text/javascript" src="../../script/public.js"></script>
<script type="text/javascript" src="../../script/echo.min.js"></script>
<script>

    var uid;
    var activity={};
    var dialogBox;
    var remainAnswerNum = null;
    apiready = function () {
        activity = api.pageParam.activity;
        initInfo(activity);
        api.hideProgress();
    };
    function initInfo(activity){
        dialogBox = api.require('dialogBox');
        addDataToHtml(activity)
    }

    function openQuestion(ret){
        if(remainAnswerNum<=0){

            dialogBox.alert ({
                texts: {
                    title: '提示',
                    content:'今天的机会已经用完了',
                    rightBtnTitle: '确定'
                },
                styles:{
                    bg: '#fff',
                    w: 300,
                    title:{
                        marginT : 20,
                        titleSize : 18,
                        titleColor : '#76CA78'
                    },
                    content:{
                        color: '#000',
                        size: 16
                    },
                    right:{
                        marginB: 0,
                        marginL: 0,
                        w: 300,
                        h: 40,
                        corner: 0,
                        bg: '#76CA78',
                        size: 16,
                        color:'#ffffff'
                    }
                }
            },function(ret){
                if (ret.eventType == 'right') {
                    dialogBox.close ({
                        dialogName: 'alert'
                    });
                }
            });
            return;
        }


        openNewWindow('question','./question.html',{activity:activity,sessionId:ret.sessionId});
    }

    function getQuestionInfo(){
        var local = $api.getStorage("local");
        var params = {};
        params.areaId = activity.areaId;
        params.aid = activity.id;
        ajaxGetWithProgress(activityAnswerStartUrl,params,function(ret){
            if(isNotBlack(ret)){
                if(!ret.answer){
                    if(ret.msg.indexOf("已抢完")){
                        dialogBox.alert ({
                            texts: {
                                title: '提示',
                                content:ret.msg,
                                rightBtnTitle: rightBtnTitle
                            },
                            styles:{
                                bg: '#fff',
                                w: 300,
                                title:{
                                    marginT : 20,
                                    titleSize : 14,
                                    titleColor : '#76CA78'
                                },
                                content:{
                                    color: '#000',
                                    size: 14
                                },
                                right:{
                                    marginB: 0,
                                    marginL: 0,
                                    w: 300,
                                    h: 35,
                                    corner: 0,
                                    bg: '#76CA78',
                                    size: 12,
                                    color:'#ffffff'
                                }
                            }
                        },function(ret){
                            if (ret.eventType == 'right') {
                                var dialogBox = api.require('dialogBox');
                                dialogBox.close ({
                                    dialogName: 'alert'
                                });
                            }
                        });
                    }else{
                        showDialog(dialogBox,ret.msg,"取消",'去完善',openUserInfo);
                    }
                }else{
                    openQuestion(ret);
                }
            }else{
                toast("网络不给力")
            }

        })
    }
    function addDataToHtml(results) {
        var data =null;
        if(results){
            var htmlDecode = "";
            if(isNotBlack(results.content)){
                htmlDecode = decodeURIComponent(results.content);
            }
            results.contentDecode = htmlDecode;
            data = {list: results};
            remainAnswerNum = results.remainAnswerNum;
        }else{
            var htmlDecode = "";
            if(isNotBlack(results.content)){
                htmlDecode = decodeURIComponent(activity.content);
            }
            activity.contentDecode = htmlDecode;
            data = {list: activity};
        }
        var html = template('scriptDiv', data);
        document.getElementById('main').innerHTML = html;

    }


    function openUserInfo(){
        var dialogBox = api.require('dialogBox');
        dialogBox.close ({
            dialogName: 'alert'
        });
        openNewWindow("userInfo","../user/userInfo.html");
    }
</script>

</html>